<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ajax，jQuery插件用法</title>
    <meta name="generator" content="VuePress 1.7.0">
    <link rel="apple-touch-icon" href="/docs/apple-touch-icon.png">
    <link rel="icon" href="/docs/favicon.ico">
    <link rel="manifest" href="/docs/manifest.json">
    <meta name="description" content="学到的 用到的 感兴趣的">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.f7b3d1c5.css" as="style"><link rel="preload" href="/docs/assets/js/app.ebbf42bd.js" as="script"><link rel="preload" href="/docs/assets/js/2.e91ea41e.js" as="script"><link rel="preload" href="/docs/assets/js/20.a4e19a04.js" as="script"><link rel="preload" href="/docs/assets/js/3.f31d052a.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.b4b51801.js"><link rel="prefetch" href="/docs/assets/js/11.a431a81f.js"><link rel="prefetch" href="/docs/assets/js/12.1f6b7235.js"><link rel="prefetch" href="/docs/assets/js/13.d9ff6aa4.js"><link rel="prefetch" href="/docs/assets/js/14.f7885770.js"><link rel="prefetch" href="/docs/assets/js/15.17c99732.js"><link rel="prefetch" href="/docs/assets/js/16.71c687bf.js"><link rel="prefetch" href="/docs/assets/js/17.8ad4810f.js"><link rel="prefetch" href="/docs/assets/js/18.fd691143.js"><link rel="prefetch" href="/docs/assets/js/19.afb702b1.js"><link rel="prefetch" href="/docs/assets/js/21.8b804b37.js"><link rel="prefetch" href="/docs/assets/js/22.b82986ab.js"><link rel="prefetch" href="/docs/assets/js/23.7917dd64.js"><link rel="prefetch" href="/docs/assets/js/24.2b2e5ffb.js"><link rel="prefetch" href="/docs/assets/js/25.48503e12.js"><link rel="prefetch" href="/docs/assets/js/26.efa1f7d6.js"><link rel="prefetch" href="/docs/assets/js/27.b7c67ff6.js"><link rel="prefetch" href="/docs/assets/js/28.43e104a6.js"><link rel="prefetch" href="/docs/assets/js/29.4d280c4e.js"><link rel="prefetch" href="/docs/assets/js/30.b22c2f67.js"><link rel="prefetch" href="/docs/assets/js/31.ad804432.js"><link rel="prefetch" href="/docs/assets/js/32.1099049b.js"><link rel="prefetch" href="/docs/assets/js/33.3dd5e29c.js"><link rel="prefetch" href="/docs/assets/js/34.98d646da.js"><link rel="prefetch" href="/docs/assets/js/35.8f1d466f.js"><link rel="prefetch" href="/docs/assets/js/36.bbed7c7a.js"><link rel="prefetch" href="/docs/assets/js/37.777ee62c.js"><link rel="prefetch" href="/docs/assets/js/38.934e506a.js"><link rel="prefetch" href="/docs/assets/js/39.2e252bff.js"><link rel="prefetch" href="/docs/assets/js/4.e3a22a46.js"><link rel="prefetch" href="/docs/assets/js/40.659d935c.js"><link rel="prefetch" href="/docs/assets/js/41.f2c2f7ee.js"><link rel="prefetch" href="/docs/assets/js/42.619321e9.js"><link rel="prefetch" href="/docs/assets/js/43.42d4eb10.js"><link rel="prefetch" href="/docs/assets/js/44.cb7ff5d2.js"><link rel="prefetch" href="/docs/assets/js/45.6e09cc4a.js"><link rel="prefetch" href="/docs/assets/js/46.dea94a79.js"><link rel="prefetch" href="/docs/assets/js/47.57b2831e.js"><link rel="prefetch" href="/docs/assets/js/48.8e723307.js"><link rel="prefetch" href="/docs/assets/js/49.e5c8403c.js"><link rel="prefetch" href="/docs/assets/js/5.1f4073b2.js"><link rel="prefetch" href="/docs/assets/js/50.d6e3c8e4.js"><link rel="prefetch" href="/docs/assets/js/51.c3667e29.js"><link rel="prefetch" href="/docs/assets/js/52.bb18881d.js"><link rel="prefetch" href="/docs/assets/js/53.be51bb0b.js"><link rel="prefetch" href="/docs/assets/js/54.840b7a76.js"><link rel="prefetch" href="/docs/assets/js/55.2fa45451.js"><link rel="prefetch" href="/docs/assets/js/56.5494f328.js"><link rel="prefetch" href="/docs/assets/js/57.38d0acdd.js"><link rel="prefetch" href="/docs/assets/js/58.6ebf3d7a.js"><link rel="prefetch" href="/docs/assets/js/59.d3d76087.js"><link rel="prefetch" href="/docs/assets/js/6.fbc0230d.js"><link rel="prefetch" href="/docs/assets/js/60.967b85b2.js"><link rel="prefetch" href="/docs/assets/js/61.43942bea.js"><link rel="prefetch" href="/docs/assets/js/62.2448d643.js"><link rel="prefetch" href="/docs/assets/js/63.2a2d7f97.js"><link rel="prefetch" href="/docs/assets/js/64.42a5680c.js"><link rel="prefetch" href="/docs/assets/js/65.12f7634e.js"><link rel="prefetch" href="/docs/assets/js/66.83f182f5.js"><link rel="prefetch" href="/docs/assets/js/67.791074e3.js"><link rel="prefetch" href="/docs/assets/js/68.f57897f8.js"><link rel="prefetch" href="/docs/assets/js/7.170c203a.js"><link rel="prefetch" href="/docs/assets/js/8.280ea156.js"><link rel="prefetch" href="/docs/assets/js/9.85c7d6b8.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.f7b3d1c5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/favicon.ico" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/backend/dot-net-mvc5/" class="nav-link router-link-active">
  .NET MVC5
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/gRPC/" class="nav-link">
  Grpc
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/container/" class="nav-link">
  容器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/echarts/" class="nav-link">
  Echarts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/more/books/" class="nav-link">
  看过的书
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/toos/" class="nav-link">
  折腾
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/leetcode/" class="nav-link">
  LeetCode
</a></li></ul></div></div> <a href="https://github.com/WuHaaaaa/WuHaaaaa.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/backend/dot-net-mvc5/" class="nav-link router-link-active">
  .NET MVC5
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/gRPC/" class="nav-link">
  Grpc
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/container/" class="nav-link">
  容器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/echarts/" class="nav-link">
  Echarts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/more/books/" class="nav-link">
  看过的书
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/toos/" class="nav-link">
  折腾
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/docs/more/leetcode/" class="nav-link">
  LeetCode
</a></li></ul></div></div> <a href="https://github.com/WuHaaaaa/WuHaaaaa.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>.NET MVC 5</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/backend/dot-net-mvc5/" aria-current="page" class="sidebar-link">首页</a></li><li><a href="/docs/backend/dot-net-mvc5/01asp-dot-net-mvc5.html" class="sidebar-link">控制器、试图、模型</a></li><li><a href="/docs/backend/dot-net-mvc5/02asp-dot-net-mvc5.html" class="sidebar-link">表单和HTML辅助方法</a></li><li><a href="/docs/backend/dot-net-mvc5/03asp-dot-net-mvc5.html" class="sidebar-link">数据注解，验证</a></li><li><a href="/docs/backend/dot-net-mvc5/04asp-dot-net-mvc5.html" class="sidebar-link">安全性、权限验证、角色成员分配</a></li><li><a href="/docs/backend/dot-net-mvc5/05asp-dot-net-mvc5.html" aria-current="page" class="active sidebar-link">Ajax，jQuery插件用法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/backend/dot-net-mvc5/05asp-dot-net-mvc5.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/docs/backend/dot-net-mvc5/05asp-dot-net-mvc5.html#正文" class="sidebar-link">正文</a></li><li class="sidebar-sub-header"><a href="/docs/backend/dot-net-mvc5/05asp-dot-net-mvc5.html#书中建议" class="sidebar-link">书中建议</a></li></ul></li><li><a href="/docs/backend/dot-net-mvc5/06asp-dot-net-mvc5.html" class="sidebar-link">路由概念，底层实现</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <blockquote><p>这一章，对应的是书上的第第八章，主要讲述Ajax，jQuery插件用法，对于我来说，查漏补缺最重要</p></blockquote> <h2 id="正文"><a href="#正文" class="header-anchor">#</a> 正文</h2> <h3 id="自定义脚本"><a href="#自定义脚本" class="header-anchor">#</a> 自定义脚本</h3> <p>个人脚本与公共脚本分开放置，个人脚本应放置于<code>/Scripts/App</code>目录下</p> <h3 id="引用脚本"><a href="#引用脚本" class="header-anchor">#</a> 引用脚本</h3> <p>引用公共脚本，可以使用<code>BundleConfig.cs</code>，按需加载<code>*.js</code>还是<code>*.min.js</code></p> <p>引用时，将<code>jQuery</code>放置于布局页底部，这样不影响顶部<code>html</code>渲染，<code>js</code>报错了，不至于没有任何内容</p> <p>下面这种是推荐做法，这样也只需引入一次<code>jQuery</code>即可，其他依赖于jQuery的js也可以在子页面使用</p> <p>_Layout.cshtml</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--html元素--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        ...
        @RenderBody()
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--大型js，放入底部，不会由于报错，而影响页面加载--&gt;</span>
    @Scripts.Render(&quot;~/bundles/jquery&quot;)
    @Scripts.Render(&quot;~/bundles/bootstrap&quot;)
    <span class="token comment">&lt;!--留一个节供子页面的加载js--&gt;</span>
    @RenderSection(&quot;scripts&quot;, required: false)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>/Home/Index.cshtml</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

@section Scripts {
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/App/MusicScripts.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
}
</code></pre></div><p>具体的加载顺序是：</p> <ol><li><code>Layout</code>中的<code>html</code></li> <li><code>Index</code>中的<code>html</code></li> <li><code>Layout</code>中的<code>jQuery</code></li> <li><code>Index</code>中的<code>MusicScripts</code></li></ol> <h3 id="使用ajax辅助方法-actionlink"><a href="#使用ajax辅助方法-actionlink" class="header-anchor">#</a> 使用Ajax辅助方法（ActionLink）</h3> <p><code>ASP.NET MVC 5</code>中也提供了对应的Ajax辅助方法，这有助于我们编写非侵入式代码</p> <p>具体步骤如下：</p> <p>我们需要一个<code>js文件</code>引用，<code>jquery.unobtrusive-ajax.js</code></p> <ol><li><p>下载NuGet包，<code>Install-Package Microsoft.jQuery.Unobtrusive.Ajax</code></p></li> <li><p>引用包文件至所需页面（我是随便找的一个页面）</p> <p><code>/StoreManager/Create.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dailydeal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    @Ajax.ActionLink(&quot;Click here&quot;,
    &quot;DailyDeal&quot;,
    null,
    new AjaxOptions
    {
        UpdateTargetId = &quot;dailydeal&quot;,   //服务器响应后，更新到DOM，
        //更新的时候模式：替换（将之前元素替换掉）
        //、插入到元素之前、插入到元素之后、整个替换（即当前容器dailydeal也不剩，全换掉）
        InsertionMode = InsertionMode.Replace,	//这里是替换  
        //请求方式
        HttpMethod = &quot;GET&quot;,
        //可以添加Confirm弹窗
        Confirm = &quot;do you like it ?&quot;,
    },
    //设置a标签样式
    new { @class = &quot;btn btn-primary&quot; });
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

@section Scripts {
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/jquery.unobtrusive-ajax.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
}
</code></pre></div><p>注：<code>Ajax</code>辅助方法需要配合安装的<code>js</code>文件一同使用，否则，<code>Ajax</code>生成的方法，只是单独的一个<code>Ajax</code>请求，不会有将结果返回，替换某元素之说，而是会直接跳转到一个新的页面</p></li> <li><p>后端代码</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">ActionResult</span> <span class="token function">DailyDeal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Json</span><span class="token punctuation">(</span>JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token punctuation">{</span> Code <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Message <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> JsonRequestBehavior<span class="token punctuation">.</span>AllowGet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>效果预览</p> <p><img src="https://i.imgur.com/2W6y2oi.gif" alt=""></p></li></ol> <h3 id="使用ajax表单-beginfrom"><a href="#使用ajax表单-beginfrom" class="header-anchor">#</a> 使用Ajax表单（BeginFrom）</h3> <p><code>BeginForm</code>常用于查询之类的地方</p> <p>前端代码</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel panel-default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-heading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Artist search<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        //生成一个Form表单
        @using (Ajax.BeginForm(&quot;ArtistSearch&quot;, &quot;StoreManager&quot;,
            new AjaxOptions
            {
                InsertionMode = InsertionMode.Replace,	//插入模式：替换
                HttpMethod = &quot;GET&quot;,					  //get请求
                OnFailure = &quot;searchFailed&quot;,				//请求失败，调用函数
                LoadingElementId = &quot;ajax-loader&quot;,		//请求时，加载中的元素显示（类似于动画效果）
                UpdateTargetId = &quot;searchresults&quot;,		//更新至哪个元素
            }))
        {
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>q<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ajax-loader<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>glyphicon glyphicon-transfer<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span>none</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
        }
        <span class="token comment">&lt;!--这个就是接收更新的地方--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchresults<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

@section Scripts {
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/jquery.unobtrusive-ajax.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">//当请求出现错误时，调用方法，提示用户</span>
    <span class="token keyword">function</span> <span class="token function">searchFailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#searchresults&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry,...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>后端代码</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">ActionResult</span> <span class="token function">ArtistSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//睡眠5秒，我们可以看一下加载中的动画效果</span>
    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//随机生成五个数</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Random</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//我们可以返回部分视图，更灵活的渲染页面</span>
    <span class="token keyword">return</span> <span class="token function">PartialView</span><span class="token punctuation">(</span><span class="token string">&quot;_Result&quot;</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>部分视图<code>_Result.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code>@model IEnumerable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchresults<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        @foreach (var item in (List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>)Model)
        {
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>@item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        }
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>效果预览（当点击时，会出现一个传输的标识）</p> <p><img src="https://i.imgur.com/wtil53R.gif" alt=""></p> <h3 id="使用jquery验证"><a href="#使用jquery验证" class="header-anchor">#</a> 使用<code>Jquery</code>验证</h3> <p>在填写表单时候，我们可能需要限制用户填写数据，例如：必填项、数字、数字范围、时间范围等，这时候，可以使用<code>Jquery</code>提供的表单验证<code>JS</code>库，在前面应该有记录用法</p> <p>前端<code>/Account/Login.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

@section Scripts{
	@Scripts.Render(&quot;~/bundles/jqueryval&quot;)
}
</code></pre></div><p>后端<code>/App_Start/BundleConfig.cs</code></p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code>bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jqueryval&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
    <span class="token string">&quot;~/Scripts/jquery.validate*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当然，我们也可以禁用非侵入式JavaScript和客户端验证</p> <p>很简单，<code>web.config</code>中，配置一下</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
	...
    <span class="token comment">&lt;!--将以下两个任意值，改为false即可--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClientValidationEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
    <span class="token comment">&lt;!----&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UnobtrusiveJavaScriptEnabled<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们也可以将这里配置了之后，在单个页面中启用、禁用相关功能</p> <div class="language-html extra-class"><pre class="language-html"><code>@model MVCMusicStore_m.Models.Album
@{
    //执行脚本输入验证：true|false
    Html.EnableClientValidation(false);
    //启用非介入式脚本：true|false
    Html.EnableUnobtrusiveJavaScript(false);
}

@{
    ViewBag.Title = &quot;Create&quot;;
}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--其他代码--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>都设置为<code>false</code>后，界面的Ajax请求异步请求，使用不了，提交表单，会出现验证，但是会弹出到新页面</p> <p><img src="https://i.imgur.com/6Er8Ama.gif" alt=""></p> <p>启用验证，禁用非介入式脚本</p> <p><img src="https://i.imgur.com/ycpVHlM.gif" alt=""></p> <p>禁用验证，启用非介入式脚本</p> <p><img src="https://i.imgur.com/TJ1MGAu.gif" alt=""></p> <p>全部功能启用</p> <p><img src="https://i.imgur.com/eNuaacj.gif" alt=""></p> <h3 id="自定义验证"><a href="#自定义验证" class="header-anchor">#</a> 自定义验证</h3> <p>在上面引用的示例中，Price字段就是有验证的字段，我们可以自定义验证规则</p> <p>例如在Model中添加相应的特性</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">//字段不允许为空，否则提示</span>
<span class="token punctuation">[</span><span class="token function">Required</span><span class="token punctuation">(</span>ErrorMessage <span class="token operator">=</span> <span class="token string">&quot;This filed is required&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">//最大字符串长度不能超过160个字符，否则提示</span>
<span class="token comment">//{0}占位，表示当前字段</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MaxLength</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">,</span>ErrorMessage <span class="token operator">=</span><span class="token string">&quot;the field {0} must be a string with a maximum length of 160.&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Title <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>前端，我们需要引用相关的验证</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--表单中--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        @Html.LabelFor(model =&gt; model.Title, htmlAttributes: new { @class = &quot;control-label col-md-2&quot; })
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            @Html.EditorFor(model =&gt; model.Title, new { htmlAttributes = new { @class = &quot;form-control&quot; } })
            <span class="token comment">&lt;!--错误信息输出--&gt;</span>
            @Html.ValidationMessageFor(model =&gt; model.Title, &quot;&quot;, new { @class = &quot;text-danger&quot; })
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
@section Scripts {
	@Scripts.Render(&quot;~/bundles/jqueryval&quot;)
}
</code></pre></div><p>而后我们观察生成页面的html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--这个就是生成后的HTML--&gt;</span>
<span class="token comment">&lt;!--input标签--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control text-box single-line<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>the field Title must be a string with a maximum length of 160.<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxlength-max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>160<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>This filed is required<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--用于显示错误信息--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field-validation-valid text-danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-valmsg-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-valmsg-replace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>代码中有<code>data-val</code>开头属性的地方，则是<code>jquery.valiidate.unobtrusive</code>脚本负责，它会通过点击、焦点事件给用户提供即时的错误反馈，然后当有错误的时候，它也可以阻止表单的提交，这样就少了一步在服务器上处理错误的步骤。</p> <p>前面曾实现过一个<code>MaxWords</code>的自定义验证属性，用于验证最淡单词数目不得超过规定数目，不过是服务端的验证，如果我们需要在客户端进行验证，则需要做进一步的工作。</p> <p>如果要在客户端执行验证，需要提供下面几点信息：</p> <ul><li><p>如果验证失败，要显示的提示信息</p></li> <li><p>允许单词数的范围</p></li> <li><p>一段用来计算单词数量的<code>JavaScript</code>代码</p> <p>这些是我们下面要实现接口的方法中需要返回的数据</p></li></ul> <p>原始代码</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 自定义验证逻辑</span>
<span class="token comment">/// 允许用户输入姓氏，单词量不超过10个</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MaxWordsAttribute</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ValidationAttribute</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name"><span class="token keyword">int</span></span> _maxWords<span class="token punctuation">;</span>
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// 创建构造函数，传入限制单词的最大个数</span>
    <span class="token comment">/// 提供一个默认的错误提示消息（在没有指定ErrorMessage时使用，同时支持多语言）</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token comment">/// &lt;param name=&quot;maxWords&quot;&gt;&lt;/param&gt;</span>
    <span class="token keyword">public</span> <span class="token function">MaxWordsAttribute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> maxWords<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;{0} has too many words.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _maxWords <span class="token operator">=</span> maxWords<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">ValidationResult</span> <span class="token function">IsValid</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token class-name">ValidationContext</span> validationContext<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//value 即表示输入的值，若输入不为空，则进行验证单词长度</span>
        <span class="token comment">//否则返回Success，表示验证通过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">value</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> valueAsString <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//计算单词数</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>valueAsString<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> _maxWords<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//DisplayName表示当前正在验证的字段名，用来格式化错误信息（{0}的占位）</span>
                <span class="token class-name"><span class="token keyword">var</span></span> errorMessage <span class="token operator">=</span> <span class="token function">FormatErrorMessage</span><span class="token punctuation">(</span>validationContext <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> validationContext<span class="token punctuation">.</span>DisplayName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//返回格式化后的错误信息</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ValidationResult</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//也可以指定返回固定字符串（但是这么做不灵活，而且也不支持多语言）</span>
                <span class="token comment">//return new ValidationResult(&quot;Too many words.&quot;);</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> ValidationResult<span class="token punctuation">.</span>Success<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>改版后：</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 自定义验证逻辑</span>
<span class="token comment">/// 允许用户输入姓氏，单词量不超过10个</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MaxWordsAttribute</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ValidationAttribute</span><span class="token punctuation">,</span> <span class="token class-name">IClientValidatable</span></span> <span class="token comment">/*实现这个接口的方法，帮助查找验证对象，并发送给客户端的元数据和规则,以便进行前端验证*/</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name"><span class="token keyword">int</span></span> _maxWords<span class="token punctuation">;</span>
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// 创建构造函数，传入限制单词的最大个数</span>
    <span class="token comment">/// 提供一个默认的错误提示消息（在没有指定ErrorMessage时使用，同时支持多语言）</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token comment">/// &lt;param name=&quot;maxWords&quot;&gt;&lt;/param&gt;</span>
    <span class="token keyword">public</span> <span class="token function">MaxWordsAttribute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> maxWords<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;{0} has too many words.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _maxWords <span class="token operator">=</span> maxWords<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
    <span class="token comment">//这个方法就是实现的接口方法</span>
    <span class="token comment">//可以一次返回多个类型验证（返回多个规则）</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>ModelClientValidationRule<span class="token punctuation">&gt;</span></span> <span class="token function">GetClientValidationRules</span><span class="token punctuation">(</span><span class="token class-name">ModelMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">ControllerContext</span> context<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//创建一个验证规则</span>
        <span class="token class-name"><span class="token keyword">var</span></span> rule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ModelClientValidationRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//错误提示</span>
        rule<span class="token punctuation">.</span>ErrorMessage <span class="token operator">=</span> <span class="token function">FormatErrorMessage</span><span class="token punctuation">(</span>metadata <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> metadata<span class="token punctuation">.</span><span class="token function">GetDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//集中存放客户端需要参数，可以放置多个参数</span>
        rule<span class="token punctuation">.</span>ValidationParameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;wordcount&quot;</span><span class="token punctuation">,</span> _maxWords<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//标识客户端需要额外的一段JavaScript</span>
        rule<span class="token punctuation">.</span>ValidationType <span class="token operator">=</span> <span class="token string">&quot;maxwords&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">yield</span> <span class="token keyword">return</span> rule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">ValidationResult</span> <span class="token function">IsValid</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token class-name">ValidationContext</span> validationContext<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//value 即表示输入的值，若输入不为空，则进行验证单词长度</span>
        <span class="token comment">//否则返回Success，表示验证通过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">value</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> valueAsString <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//计算单词数</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>valueAsString<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> _maxWords<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//DisplayName表示当前正在验证的字段名，用来格式化错误信息（{0}的占位）</span>
                <span class="token class-name"><span class="token keyword">var</span></span> errorMessage <span class="token operator">=</span> <span class="token function">FormatErrorMessage</span><span class="token punctuation">(</span>validationContext <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> validationContext<span class="token punctuation">.</span>DisplayName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//返回格式化后的错误信息</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ValidationResult</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//也可以指定返回固定字符串（但是这么做不灵活，而且也不支持多语言）</span>
                <span class="token comment">//return new ValidationResult(&quot;Too many words.&quot;);</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> ValidationResult<span class="token punctuation">.</span>Success<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后前端渲染后，Title字段的输入框，将会多出两个属性，这表示我们添加的前端验证规则生效了</p> <p>后端模型</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Required</span><span class="token attribute-arguments"><span class="token punctuation">(</span>ErrorMessage <span class="token operator">=</span> <span class="token string">&quot;This filed is required&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MaxLength</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">,</span>ErrorMessage <span class="token operator">=</span><span class="token string">&quot;the field {0} must be a string with a maximum length of 160.&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MaxWords</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Title <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>前端渲染界面</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control text-box single-line<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>the field Title must be a string with a maximum length of 160.<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxlength-max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>160<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxwords</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title has too many words.<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-maxwords-wordcount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-val-required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>This filed is required<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>其中<code>data-val-maxwords</code>与<code>data-val-maxwords-wordcount</code>就是根据代码返回的验证规则新增的</p> <p>其后，我们还需要一些验证逻辑，才能使这两个验证规则生效，当填写了错误信息，才会触发阻止提交。</p> <p>新增<code>JavaScript</code>，<code>/Scripts/App/CustomValidators.js</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//适配器：帮助data-val检索值将数据转为jQuery验证可以理解的格式</span>
<span class="token comment">//第一个参数：适配器名称（与服务端设置ValidationProperty一样），第二个参数：ValidationParameters的参数名称</span>
$<span class="token punctuation">.</span>validator<span class="token punctuation">.</span>unobtrusive<span class="token punctuation">.</span>adapters<span class="token punctuation">.</span><span class="token function">addSingleVal</span><span class="token punctuation">(</span><span class="token string">&quot;maxwords&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wordcount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//验证规则(验证器)“addMethod表示添加新验证器”</span>
<span class="token comment">//验证器名称：maxwords适配ValidationType属性值</span>
$<span class="token punctuation">.</span>validator<span class="token punctuation">.</span><span class="token function">addMethod</span><span class="token punctuation">(</span><span class="token string">&quot;maxwords&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> element<span class="token punctuation">,</span> maxwords</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//value:输入值，element:参数输入元素，maxwords:所有验证参数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> maxwords<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><center>适配器方法</center>
| 名称           | 描述                                                         |
| -------------- | ------------------------------------------------------------ |
| `addBool`      | 启用或禁用验证规则创建适配器，规则不需要额外参数             |
| `addSingleVal` | 为需要从元数据中检索唯一参数值的验证规则创建适配器           |
| `addMinMax`    | 创建一个验证规则集适配器，一个检查最小值，一个检测最大值，两个规则中至少有一个要依靠得到的数据运行 |
| `Add`          | 创建一个不适合前面类别的适配器，需要额外参数、设置额外代码   |
<h3 id="使用jquery-ui"><a href="#使用jquery-ui" class="header-anchor">#</a> 使用jQuery UI</h3> <p>在实际使用中，为了提升用户体验，我们通常会在<code>web</code>项目中添加一些动画效果</p> <p>比如下面的代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> height<span class="token operator">:</span> <span class="token string">&quot;+=25&quot;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&quot;+=25&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
            <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> height<span class="token operator">:</span> <span class="token string">&quot;-=25&quot;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&quot;-=25&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>对应的示例</p> <p><img src="https://i.imgur.com/WiOAie6.gif" alt=""></p> <p>对于上面的这种动画，我们可以使用<code>jQuery UI</code>更快的实现，步骤如下：</p> <ul><li><p>安装<code>jQuery UI</code>相关的包</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Install-Package jQuery.UI.Combined
</code></pre></div></li> <li><p>然后我们引入到项目中，如果一个项目太多页面需要使用，我们就可以放置在<code>_Layout.cshtml</code>中，引用一次，使用多次</p> <p>_Layout.cshtml</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container body-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        @RenderBody()
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;copy;">&amp;copy;</span> @DateTime.Now.Year - 我的 ASP.NET 应用程序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    @Scripts.Render(&quot;~/bundles/jquery&quot;)
    @Scripts.Render(&quot;~/bundles/bootstrap&quot;)
    <span class="token comment">&lt;!--引入jQuery UI--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/jquery-ui-1.12.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    @RenderSection(&quot;scripts&quot;, required: false)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>或者使用下面这种方式引入，方便更新</p> <p>_Layout.cshtml</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container body-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        @RenderBody()
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;copy;">&amp;copy;</span> @DateTime.Now.Year - 我的 ASP.NET 应用程序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    @Scripts.Render(&quot;~/bundles/jquery&quot;)
    @Scripts.Render(&quot;~/bundles/bootstrap&quot;)
    <span class="token comment">&lt;!--不使用这种方式--&gt;</span>
    @*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/jquery-ui-1.12.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>*@
    <span class="token comment">&lt;!--引入jQuery UI--&gt;</span>
	@Scripts.Render(&quot;~/bundles/jqueryui&quot;)
    @RenderSection(&quot;scripts&quot;, required: false)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>/App_Start/BundleConfig.cs</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">//添加一个新的关于jQueryUI的引用</span>
bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jqueryui&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
    <span class="token string">&quot;~/Scripts/jquery-ui-{version}.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>现在可以更简单的实现按钮覆盖的动画效果</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token string">&quot;bounce&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>示例</p> <p><img src="https://i.imgur.com/9fgdrL7.gif" alt=""></p> <p>还可以调整参数，例如动画执行时间，跳动范围</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#dailydeal a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token string">&quot;bounce&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>time<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>distance<span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>示例（可以看到，它的跳动范围更大一些）</p> <p><img src="https://i.imgur.com/nxF7PuT.gif" alt=""></p></li></ul> <h3 id="使用jquery-ui完成搜索功能"><a href="#使用jquery-ui完成搜索功能" class="header-anchor">#</a> 使用jQuery UI完成搜索功能</h3> <p>示例中的搜索，我们可以使用<code>jQuery UI</code>来实现用户输入文本时，提示一部分内容给用户，用户点击，则会输入到输入框</p> <ul><li><p>首先需要引入<code>jQuery UI.css</code>，<code>_Layout.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>@ViewBag.Title - 我的 ASP.NET 应用程序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        @Styles.Render(&quot;~/Content/css&quot;)
        @Scripts.Render(&quot;~/bundles/modernizr&quot;)
	    <span class="token comment">&lt;!--引入基础的css--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Content/themes/base/jquery-ui.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>绑定<code>autocomplete</code>属性绑定到<code>input</code>标签上</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel panel-default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-heading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Artist search<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panel-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        @using (Ajax.BeginForm(&quot;ArtistSearch&quot;, &quot;StoreManager&quot;,
            new AjaxOptions
            {
                InsertionMode = InsertionMode.Replace,
                HttpMethod = &quot;GET&quot;,
                OnFailure = &quot;searchFailed&quot;,
                LoadingElementId = &quot;ajax-loader&quot;,
                UpdateTargetId = &quot;searchresults&quot;,
            }))
        {
        	<span class="token comment">&lt;!--绑定自动完成数据源，数据通过QuickSearch提供--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>q<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-autocomplete-source</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@Url.Action(<span class="token punctuation">&quot;</span></span><span class="token attr-name">QuickSearch&quot;,&quot;StoreManager&quot;)&quot;</span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ajax-loader<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>glyphicon glyphicon-transfer<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span>none</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
        }
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchresults<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>实现后端返回数据源<code>StoreManagerController.cs</code></p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">//通过每次输入的数据查询类似的数据</span>
<span class="token punctuation">[</span>HttpGet<span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">ActionResult</span> <span class="token function">QuickSearch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> term<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> list <span class="token operator">=</span> <span class="token function">GetResultList</span><span class="token punctuation">(</span>term<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> <span class="token keyword">value</span> <span class="token operator">=</span> c <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">Json</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> JsonRequestBehavior<span class="token punctuation">.</span>AllowGet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//模拟数据源</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> GetResultList <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> term<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Ann&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Anna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Devide&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Oscar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Ken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>term<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>当页面初始化的时候，绑定相关的数据源</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#dailydeal a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">effect</span><span class="token punctuation">(</span><span class="token string">&quot;bounce&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> time<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> distance<span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//绑定自动完成提示选项，将从data-autocomplete-source中遍历数据，并实现自动完成插件</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;input[data-autocomplete-source]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target<span class="token punctuation">.</span><span class="token function">autocomplete</span><span class="token punctuation">(</span><span class="token punctuation">{</span> source<span class="token operator">:</span> target<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;data-autocomplete-source&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>实现示例</p> <p><img src="https://i.imgur.com/fn8y2iJ.gif" alt=""></p></li></ul> <h3 id="使用模板"><a href="#使用模板" class="header-anchor">#</a> 使用模板</h3> <p>JavaScript有许多的模板，我们可以使用模板来组装数据，让代码更清晰、易读。其实模板与<code>Razor</code>语言类似，通常使用固定的符号分割，渲染数据，以下是示例：<u>通过搜索请求，根据返回的<code>JSON</code>数据渲染模板。</u></p> <ul><li><p>添加模板<code>mustache.js</code>引用</p> <div class="language- extra-class"><pre class="language-text"><code>Install-Package mustache.js
</code></pre></div></li> <li><p>引用模板脚本，<code>_Layout.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>@ViewBag.Title - 我的 ASP.NET 应用程序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        @Styles.Render(&quot;~/Content/css&quot;)
        @Scripts.Render(&quot;~/bundles/modernizr&quot;)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Content/themes/base/jquery-ui.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        @* 添加模板脚本 *@
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/mustache.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>然后我们可以不使用<code>Ajax</code>辅助方法，自己编写<code>JavaScript</code>代码来向服务器请求HTML</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#artistSearch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//阻止点击submit发送提交的默认行为，改为使用load</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取当前整个form表单</span>
    <span class="token keyword">var</span> form <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//将form序列化，提取其中的值，例如表单外面只有一个输入框&quot;q&quot;，输入123提交</span>
    <span class="token comment">//那么输入的值将会以&quot;q=123&quot;这种格式提交</span>
    <span class="token comment">//load()接收两个参数，前者是form表单中的action地址，后者就是q=123，将会被提交到后台</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#searchresults&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>进行到这里，当我们点击<code>search</code>时，还是使用的部分视图，需要继续修改</p></li> <li><p>然后将之前代码返回的部分视图改为返回<code>JSON</code>格式的字符串</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">ActionResult</span> <span class="token function">ArtistSearch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> q<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> list <span class="token operator">=</span> <span class="token function">GetResultList</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">Json</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> JsonRequestBehavior<span class="token punctuation">.</span>AllowGet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//return PartialView(&quot;_Result&quot;, list);</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span> <span class="token function">GetResultList</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> term<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Ann&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Jack&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Anna&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Devide&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Oscar&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Ken&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>term<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>然后，需要修改<code>load()</code>方法为<code>getJSON()</code>，然后将返回的消息通过模板生成html，渲染到指定的位置</p> <p><code>getJSON()</code>方法可以接收<code>JSON</code>格式的数据</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#artistSearch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//阻止点击submit发送提交的默认行为，改为使用load</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取当前整个form表单</span>
    <span class="token keyword">var</span> form <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//将form序列化，提取其中的值，例如表单外面只有一个输入框&quot;q&quot;，输入123提交</span>
    <span class="token comment">//那么输入的值将会以&quot;q=123&quot;这种格式提交</span>
    <span class="token comment">//load()接收两个参数，前者是form表单中的action地址，后者就是q=123，将会被提交到后台</span>
    <span class="token comment">//$(&quot;#searchresults&quot;).load(form.attr(&quot;action&quot;), form.serialize());</span>

    <span class="token comment">//发送get请求，接收json格式数据</span>
    $<span class="token punctuation">.</span><span class="token function">getJSON</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> form<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//将使用mustache，传入模板，数据，生成html</span>
        <span class="token keyword">var</span> html <span class="token operator">=</span> Mustache<span class="token punctuation">.</span><span class="token function">to_html</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#artistTemplate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> artists<span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//放入searchresults中</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#searchresults&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>当然，不能忘记最重要的一点，模板</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>artistTemplate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
		<span class="token comment">//表示artists是一个可遍历的集合，类似于foreach</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span>#artists<span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token comment">//取artists中每个元素的Name属性,Age属性</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>Name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>Age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    	<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>artists<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>然后可以看一下效果</p> <p><img src="https://i.imgur.com/vWLHERd.gif" alt=""></p></li> <li><p>示例还有一个问题，没有加载效果，因为我们是自己实现的请求，<code>form</code>表单，这没有<code>Ajax</code>辅助方法方便，不过我们可以实现它，使用<code>jQuery</code>的<code>ajax</code>方法：最大限度的灵活性，修改渲染的提交方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#artistSearch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//阻止点击submit发送提交的默认行为，改为使用load</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取当前整个form表单</span>
    <span class="token keyword">var</span> form <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//将form序列化，提取其中的值，例如表单外面只有一个输入框&quot;q&quot;，输入123提交</span>
    <span class="token comment">//那么输入的值将会以&quot;q=123&quot;这种格式提交</span>
    <span class="token comment">//load()接收两个参数，前者是form表单中的action地址，后者就是q=123，将会被提交到后台</span>
    <span class="token comment">//$(&quot;#searchresults&quot;).load(form.attr(&quot;action&quot;), form.serialize());</span>

    <span class="token comment">////发送get请求，接收json格式数据</span>
    <span class="token comment">//$.getJSON(form.attr(&quot;action&quot;), form.serialize(), function (data) {</span>
    <span class="token comment">//    //将使用mustache，传入模板，数据，生成html</span>
    <span class="token comment">//    var html = Mustache.to_html($(&quot;#artistTemplate&quot;).html(), { artists: data });</span>
    <span class="token comment">//    //放入searchresults中</span>
    <span class="token comment">//    $(&quot;#searchresults&quot;).empty().append(html);</span>
    <span class="token comment">//});</span>
    
     $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> form<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> form<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">//请求前显示图标</span>
        <span class="token function-variable function">beforeSend</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ajax-loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//请求后隐藏图标</span>
        <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ajax-loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//请求出错，执行方法</span>
        error<span class="token operator">:</span> searchFailed<span class="token punctuation">,</span>
        <span class="token comment">//请求成功，渲染模板</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//将使用mustache，传入模板，数据，生成html</span>
            <span class="token keyword">var</span> html <span class="token operator">=</span> Mustache<span class="token punctuation">.</span><span class="token function">to_html</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#artistTemplate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> artists<span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//放入searchresults中</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#searchresults&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>再来看看效果（多了一个动画效果）</p> <p><img src="https://i.imgur.com/kEvBtzk.gif" alt=""></p></li></ul> <p><strong>结论：这与前面实现的Ajax辅助方法效果一样，为什么需要使用JSON格式的这种方式。因为前面使用部分视图，还是将整个HTML一起返回到前端的。而这种方法，就是将数据交给浏览器来渲染，减轻了服务器的压力。降低了带宽。</strong></p> <h2 id="书中建议"><a href="#书中建议" class="header-anchor">#</a> 书中建议</h2> <blockquote><p>对于开发的时候，编写自定义脚本时，建议使用非侵入式方式（即：<code>js</code>代码与<code>html</code>代码分开），这样有助于代码更清晰，更易维护。</p> <p>对于性能建立：书中看到几个，记录一下，后面应该可以用到：</p> <ul><li><p>通过网上的一些网站性能分析工具，对网站内容，加载时间，总体评分来判断性能</p></li> <li><p>通过内容分发网络（CDN）来加载一些公共的<code>js</code>类库，减少自己的服务器压力，若CDN无法访问时，应该有备用的<code>js</code>，例如：<code>jQuery</code>，<code>bootstrap</code></p> <p>微软CDN脚本版本及列表：http://www.asp.net/ajaxlibrary/CDN.ashx</p> <div class="language-html extra-class"><pre class="language-html"><code>//双斜杠开头表示（网络路径参考），当我们不确定是https的资源路径时，如果我们固定使用了http，那么将会被浏览器提示混合内容警告，所以使用&quot;//&quot;更方便些
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.10.2.min.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>脚本优化，将大型的<code>script</code>引用放置于页面底部，待页面加载<code>html</code>后，再加载，提升网页响应速度</p></li> <li><p>使用<code>BundleConfig.cs</code>，它可以将多个脚本压缩成一个，缩小文件大小，减少请求次数，缩短页面加载时间</p> <p><code>/App_Start/BundleConfig.cs</code></p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BundleConfig</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RegisterBundles</span><span class="token punctuation">(</span><span class="token class-name">BundleCollection</span> bundles<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Scripts/jquery-{version}.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jqueryval&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Scripts/jquery.validate*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/modernizr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Scripts/modernizr-*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/bootstrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Scripts/bootstrap.js&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;~/Scripts/respond.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">StyleBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/Content/css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Content/bootstrap.css&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;~/Content/site.css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jqueryui&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
            <span class="token string">&quot;~/Scripts/jquery-ui-{version}.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用示例：<code>_Layout.cshtml</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>@ViewBag.Title - 我的 ASP.NET 应用程序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        @Styles.Render(&quot;~/Content/css&quot;)
        @Scripts.Render(&quot;~/bundles/modernizr&quot;)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Content/themes/base/jquery-ui.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        @* 添加模板脚本 *@
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/mustache.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        ...
        @Scripts.Render(&quot;~/bundles/jquery&quot;)
        @Scripts.Render(&quot;~/bundles/bootstrap&quot;)
        @*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>~/Scripts/jquery-ui-1.12.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>*@
        @Scripts.Render(&quot;~/bundles/jqueryui&quot;)
        @RenderSection(&quot;scripts&quot;, required: false)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>当我们将<code>web.config</code>中的配置改为<code>debug</code>模式，<code>js</code>如果是灵活引用，就会引用未压缩版，其中源码我们可以读懂</p></li> <li><p>当将<code>web.config</code>中配置改为<code>release</code>模式，js就会自动引用<code>*.min.js</code>，减少带宽，减少服务器压力，加快页面加载速度</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">//*表示可以跟任意字符，可以根据配置，自动加载*.min.js 还是 *.js</span>
bundles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ScriptBundle</span><span class="token punctuation">(</span><span class="token string">&quot;~/bundles/jqueryval&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Include</span><span class="token punctuation">(</span>
    <span class="token string">&quot;~/Scripts/jquery.validate*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://i.imgur.com/Z2IWa3M.png" alt=""></p></li></ul></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/WuHaaaaa/WuHaaaaa.github.io/edit/master/docs/backend/dot-net-mvc5/05asp-dot-net-mvc5.md" target="_blank" rel="noopener noreferrer">编辑文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021年1月13日星期三晚上10点29分</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/backend/dot-net-mvc5/04asp-dot-net-mvc5.html" class="prev">
        安全性、权限验证、角色成员分配
      </a></span> <span class="next"><a href="/docs/backend/dot-net-mvc5/06asp-dot-net-mvc5.html">
        路由概念，底层实现
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/docs/assets/js/app.ebbf42bd.js" defer></script><script src="/docs/assets/js/2.e91ea41e.js" defer></script><script src="/docs/assets/js/20.a4e19a04.js" defer></script><script src="/docs/assets/js/3.f31d052a.js" defer></script>
  </body>
</html>
